{% extends 'base.html.twig' %}

{% block title %}Potager{% endblock %}

 {% block stylesheets %}
     {{ parent() }}
 {% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('style') }}
    {{ encore_entry_script_tags('print') }}
{% endblock %}

{% block body %}
    {% set route_name = app.request.attributes.get('_route') %}
<div class="wrapper text-center">
    <div class="row cadre_blanc_no_border" >
        <div class="entete_user">
            <h5 class="colorrose">{{user.nickname}}</h5>
            {% if user.avatar %}
                <a href="javascript:display_photo('{{ vich_uploader_asset(user.avatar) }}','500','500','Photo de profil')">
                    <h1><img src="{{ vich_uploader_asset(user.avatar) }}" alt="Image" class="img-circle" width="80" height="80"></h1>
                </a>
            {% endif %}

        </div>
        <div class="entete_stat">
            {{ include('garden/me/apercu.html.twig', { 'r_byuser' : r_byuser, 'achat' : achats, 'calories' : calories, 'user' : user }) }}
        </div>
    </div>
    <p><strong>Statistiques</strong></p>
    <p>
        {% set isGardenPast = route_name == 'gardenpast' %}
        {% set isGarden = route_name == 'garden' %}
        <a class="filtre{{ isGardenPast ? ' noir_fonce' }}" href="{{ path('gardenpast') }}" style="color:#a69b97;">
            2022
        </a>
        <a class="filtre{{ isGarden ? ' noir_fonce' }}" href="{{ path('garden') }}" style="color:#a69b97;">
            2024
        </a>
    </p>

    <div id="content">
            {{ include('garden/commun/_content.html.twig', {'p_byuser' : p_byuser, 'r_byuser' : r_byuser, 'user' : user }) }}
    </div>
    <br/>
        <p><strong>Historique</strong></p>
            {{ include('garden/me/posts.html.twig', { 'fluxes': fluxes|reverse , 'user' : user })}}
            {{ include('garden/me/plants.html.twig', { 'paniers': paniers|reverse, 'user' : user  })}}
            {{ include('garden/me/recoltes.html.twig', { 'paniers': paniers|reverse , 'user' : user }) }}
            {{ include('garden/me/achat.html.twig', { 'achats': achats|reverse , 'user' : user }) }}

        {% if app.user == user and fluxes is empty and plant == false and rec == false and achats is empty %}
        <div class="row cadre_post">
            <a href="{{ path('ajouter') }}">
                <button class="colorblue mdl-button mdl-button--raised mdl-button--colored">
                    <img class="img-responsive" src="{{ asset('images/carnet.png') }}" alt="Image" width="32" height="32">
                    Publiez un premier post
                </button>
            </a>
        </div>
        {% endif %}

        <br/>

        {% set classe = "row cadre_blanc" %}
        <p><strong>Communauté</strong></p>
        {{ include('garden/commun/amis.html.twig', { 'amis': amis , 'user' : user, 'classe' : classe})}}
    <br/>
    <div class="row cadre_blanc_no_border">
        <a href="{{'whatsapp://send?text=http://www.GreenGarden.fr/bou/' ~ user.nickname }}"> Envoyer mon jardin à un ami</a>
    </div>
    <div class="row cadre_blanc_no_border">
        <img src="{{ asset('images/meteo.png') }}" alt="Image" width="50" height="50">
        <br/>
        {% if  user.administrativearea %}
            <a target="_blank" href='https://meteofrance.com/previsions-meteo-france/{{user.administrativearea.meteolink}}' >
              Consultez la météo de votre région <br/>
                {{ user.administrativeArea.name }}
            </a>
        {% else %}
            <a href="{{ path('profile') }}"> Veuillez renseigner votre département pour accéder à la météo</a>
        {% endif %}
    </div>

</div>


{% endblock %}





